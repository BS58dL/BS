local WindUI = {
    Name = "WindUI",
    Version = "2.0",
    Creator = "BS58dL",
    Components = {},
    Flags = {},
    Config = {
        AutoSave = false,
        AutoScale = false,
        DoubleColumn = false
    }
}

-- 核心服务
local Services = setmetatable({}, {
    __index = function(_, serviceName)
        return game:GetService(serviceName)
    end
})

-- 工具函数
local function create(class, props)
    local obj = Instance.new(class)
    for prop, value in pairs(props or {}) do
        obj[prop] = value
    end
    return obj
end

local function tween(obj, props, duration, style, direction)
    style = style or "Linear"
    direction = direction or "InOut"
    duration = duration or 0.25
    
    local tweenInfo = TweenInfo.new(
        duration,
        Enum.EasingStyle[style],
        Enum.EasingDirection[direction]
    )
    
    local tween = Services.TweenService:Create(obj, tweenInfo, props)
    tween:Play()
    return tween
end

-- 主UI类
function WindUI:CreateWindow(settings)
    settings = settings or {}
    local window = {
        Name = settings.Name or "WindUI",
        Size = settings.Size or {448, 280},
        Position = settings.Position or {0.5, 0.5},
        Draggable = settings.Draggable ~= false,
        Theme = settings.Theme or {
            Primary = Color3.fromRGB(52, 62, 72),
            Secondary = Color3.fromRGB(58, 69, 80),
            Accent = Color3.fromRGB(53, 255, 134),
            Danger = Color3.fromRGB(255, 83, 83),
            Text = Color3.fromRGB(255, 255, 255)
        }
    }

    -- 主界面
    local gui = create("ScreenGui", {
        Name = window.Name,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false
    })
    
    if syn and syn.protect_gui then
        syn.protect_gui(gui)
    end
    
    gui.Parent = Services.CoreGui

    -- 主窗口
    window.MainFrame = create("ImageLabel", {
        Name = "Main",
        Parent = gui,
        BackgroundColor3 = window.Theme.Primary,
        BorderSizePixel = 0,
        Position = UDim2.new(window.Position[1], 0, window.Position[2], 0),
        Size = UDim2.new(0, window.Size[1], 0, window.Size[2]),
        AnchorPoint = Vector2.new(0.5, 0.5),
        Active = true,
        Draggable = window.Draggable,
        Image = "rbxassetid://17281420682",
        ImageTransparency = 0
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = window.MainFrame
    })

    -- 标题栏
    window.TitleBar = create("TextLabel", {
        Name = "TitleBar",
        Parent = window.MainFrame,
        BackgroundColor3 = Color3.fromRGB(25, 25, 25),
        BackgroundTransparency = 0.75,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 6, 0, 6),
        Size = UDim2.new(0, window.Size[1] - 12, 0, 24),
        Font = Enum.Font.GothamBold,
        Text = "  " .. window.Name,
        TextColor3 = window.Theme.Text,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = window.TitleBar
    })

    -- 侧边栏
    window.Sidebar = create("Frame", {
        Name = "Sidebar",
        Parent = window.MainFrame,
        BackgroundColor3 = window.Theme.Secondary,
        BackgroundTransparency = 0.75,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 6, 0, 36),
        Size = UDim2.new(0, 106, 0, window.Size[2] - 42)
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = window.Sidebar
    })

    -- 标签页按钮容器
    window.TabButtonContainer = create("ScrollingFrame", {
        Name = "TabButtons",
        Parent = window.Sidebar,
        Active = true,
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Size = UDim2.new(0, 106, 0, window.Size[2] - 42),
        ScrollBarThickness = 0
    })
    
    create("UIListLayout", {
        Parent = window.TabButtonContainer,
        HorizontalAlignment = Enum.HorizontalAlignment.Center,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5)
    })
    
    create("UIPadding", {
        Parent = window.TabButtonContainer,
        PaddingTop = UDim.new(0, 6)
    })

    -- 内容区域
    window.ContentArea = create("Frame", {
        Name = "ContentArea",
        Parent = window.MainFrame,
        BackgroundColor3 = window.Theme.Secondary,
        BackgroundTransparency = 0.75,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 118, 0, 36),
        Size = UDim2.new(0, window.Size[1] - 124, 0, window.Size[2] - 42)
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = window.ContentArea
    })

    -- 控制按钮
    window.CloseButton = create("TextButton", {
        Name = "CloseButton",
        Parent = window.MainFrame,
        BackgroundColor3 = window.Theme.Danger,
        BorderSizePixel = 0,
        Position = UDim2.new(1, -28, 0, 6),
        Size = UDim2.new(0, 22, 0, 22),
        Font = Enum.Font.GothamBold,
        Text = "✕",
        TextColor3 = window.Theme.Text,
        TextSize = 12
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = window.CloseButton
    })

    window.MinimizeButton = create("TextButton", {
        Name = "MinimizeButton",
        Parent = window.MainFrame,
        BackgroundColor3 = Color3.fromRGB(255, 165, 0),
        BorderSizePixel = 0,
        Position = UDim2.new(1, -54, 0, 6),
        Size = UDim2.new(0, 22, 0, 22),
        Font = Enum.Font.GothamBold,
        Text = "−",
        TextColor3 = window.Theme.Text,
        TextSize = 12
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = window.MinimizeButton
    })

    -- 状态管理
    window.Tabs = {}
    window.CurrentTab = nil
    window.Visible = true

    -- 标签页切换函数
    function window:SwitchTab(tab)
        if window.CurrentTab and window.CurrentTab ~= tab then
            window.CurrentTab.Content.Visible = false
            window.CurrentTab.Button.Glow.Transparency = 1
        end
        
        window.CurrentTab = tab
        tab.Content.Visible = true
        tween(tab.Button.Glow, {Transparency = 0}, 0.25, "Quint")
    end

    return window
end

-- 标签页
function WindUI:CreateTab(window, name)
    local tab = {
        Name = name,
        Window = window
    }

    -- 标签页按钮
    tab.Button = create("TextButton", {
        Name = "TabButton",
        Parent = window.TabButtonContainer,
        BackgroundColor3 = Color3.fromRGB(52, 62, 72),
        BackgroundTransparency = 0.75,
        BorderSizePixel = 0,
        Size = UDim2.new(0, 94, 0, 28),
        AutoButtonColor = false,
        Font = Enum.Font.GothamSemibold,
        Text = name,
        TextColor3 = WindUI.Theme.Text,
        TextSize = 14
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = tab.Button
    })

    -- 激活指示器
    tab.Button.Glow = create("Frame", {
        Name = "Glow",
        Parent = tab.Button,
        BackgroundColor3 = Color3.fromRGB(255, 255, 255),
        BorderSizePixel = 0,
        Position = UDim2.new(0, 0, 0.928571, 0),
        Size = UDim2.new(0, 94, 0, 2),
        Transparency = 1
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = tab.Button.Glow
    })

    -- 内容容器
    tab.Content = create("ScrollingFrame", {
        Name = "TabContent",
        Parent = window.ContentArea,
        Active = true,
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 1, 0),
        ScrollBarThickness = 0,
        Visible = false
    })
    
    local layout = create("UIListLayout", {
        Parent = tab.Content,
        HorizontalAlignment = Enum.HorizontalAlignment.Center,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 6)
    })
    
    create("UIPadding", {
        Parent = tab.Content,
        PaddingTop = UDim.new(0, 6)
    })

    -- 自动调整画布大小
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        tab.Content.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 12)
    end)

    -- 点击切换
    tab.Button.MouseButton1Click:Connect(function()
        window:SwitchTab(tab)
    end)

    -- 如果是第一个标签页，自动激活
    if not window.CurrentTab then
        window:SwitchTab(tab)
    end

    table.insert(window.Tabs, tab)

    -- 组件创建函数
    function tab:Separator()
        create("Frame", {
            Parent = tab.Content,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 0, 0, 6)
        })
    end

    function tab:Button(text, callback)
        callback = callback or function() end
        
        local button = create("TextButton", {
            Name = "Button",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = button
        })

        button.MouseButton1Click:Connect(callback)
        return button
    end

    function tab:Toggle(text, flag, callback, default)
        callback = callback or function() end
        flag = flag or text
        
        local toggle = {
            State = default or false,
            Flag = flag
        }

        local button = create("TextButton", {
            Name = "Toggle",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = button
        })

        -- 关闭状态
        local offFrame = create("Frame", {
            Name = "OffStatus",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(255, 83, 83),
            BorderSizePixel = 0,
            Position = UDim2.new(0.878, 0, 0.179, 0),
            Size = UDim2.new(0, 34, 0, 18)
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = offFrame
        })

        -- 开启状态
        local onFrame = create("Frame", {
            Name = "OnStatus",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(53, 255, 134),
            BorderSizePixel = 0,
            Position = UDim2.new(0.878, 0, 0.179, 0),
            Size = UDim2.new(0, 34, 0, 18),
            Transparency = 1
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = onFrame
        })

        function toggle:SetState(state)
            self.State = state
            tween(onFrame, {Transparency = state and 0 or 1}, 0.25, "Linear")
            tween(offFrame, {Transparency = state and 1 or 0}, 0.25, "Linear")
            callback(state)
        end

        button.MouseButton1Click:Connect(function()
            toggle:SetState(not toggle.State)
        end)

        -- 注册到全局
        WindUI.Flags[flag] = toggle
        
        -- 设置初始状态
        toggle:SetState(toggle.State)
        
        return toggle
    end

    function tab:Slider(text, flag, min, max, default, callback, isDecimal)
        callback = callback or function() end
        flag = flag or text
        default = default or min

        local slider = {
            Value = default,
            Min = min,
            Max = max,
            Flag = flag
        }

        local button = create("TextButton", {
            Name = "Slider",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = button
        })

        -- 滑块条
        local sliderBar = create("Frame", {
            Name = "SliderBar",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(58, 69, 80),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Position = UDim2.new(0.442, 0, 0.393, 0),
            Size = UDim2.new(0, 108, 0, 6)
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 2),
            Parent = sliderBar
        })

        -- 滑块填充
        local sliderFill = create("Frame", {
            Name = "SliderFill",
            Parent = sliderBar,
            BackgroundColor3 = Color3.fromRGB(255, 255, 255),
            BorderSizePixel = 0,
            Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 2),
            Parent = sliderFill
        })

        -- 数值显示
        local valueBox = create("TextBox", {
            Name = "ValueBox",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(58, 69, 80),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Position = UDim2.new(0.885, 0, 0.179, 0),
            Size = UDim2.new(0, 32, 0, 18),
            Font = Enum.Font.Gotham,
            Text = tostring(default),
            TextColor3 = WindUI.Theme.Text,
            TextSize = 12,
            TextWrapped = true
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = valueBox
        })

        function slider:SetValue(value)
            value = math.clamp(value, min, max)
            if isDecimal then
                value = tonumber(string.format("%.1f", value))
            else
                value = math.floor(value)
            end
            
            self.Value = value
            valueBox.Text = tostring(value)
            
            local percentage = (value - min) / (max - min)
            sliderFill.Size = UDim2.new(percentage, 0, 1, 0)
            
            callback(value)
        end

        -- 拖拽逻辑
        local dragging = false
        
        sliderBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
            end
        end)
        
        Services.UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        Services.UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local relativePos = Services.UserInputService:GetMouseLocation().X - sliderBar.AbsolutePosition.X
                local percentage = math.clamp(relativePos / sliderBar.AbsoluteSize.X, 0, 1)
                local value = min + (max - min) * percentage
                slider:SetValue(value)
            end
        end)

        -- 数值输入
        local userTyping = false
        
        valueBox.Focused:Connect(function()
            userTyping = true
        end)
        
        valueBox.FocusLost:Connect(function()
            userTyping = false
            local num = tonumber(valueBox.Text)
            if num then
                slider:SetValue(num)
            else
                valueBox.Text = tostring(slider.Value)
            end
        end)
        
        valueBox:GetPropertyChangedSignal("Text"):Connect(function()
            if userTyping then
                local num = tonumber(valueBox.Text)
                if num then
                    slider:SetValue(num)
                end
            end
        end)

        -- 注册到全局
        WindUI.Flags[flag] = slider
        
        return slider
    end

    function tab:Dropdown(text, flag, options, callback)
        callback = callback or function() end
        flag = flag or text
        
        local dropdown = {
            Value = options[1],
            Options = options,
            Flag = flag,
            IsOpen = false
        }

        local mainButton = create("TextButton", {
            Name = "Dropdown",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text .. " - " .. dropdown.Value,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = mainButton
        })

        local openButton = create("TextButton", {
            Name = "OpenButton",
            Parent = mainButton,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Position = UDim2.new(0.907, 0, 0.179, 0),
            Size = UDim2.new(0, 18, 0, 18),
            Font = Enum.Font.Gotham,
            Text = "+",
            TextColor3 = WindUI.Theme.Text,
            TextSize = 22
        })

        -- 选项容器
        local optionContainer = create("ScrollingFrame", {
            Name = "OptionContainer",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            ClipsDescendants = true,
            Size = UDim2.new(0, 312, 0, 0),
            Visible = false,
            ScrollBarThickness = 0
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = optionContainer
        })
        
        local layout = create("UIListLayout", {
            Parent = optionContainer,
            HorizontalAlignment = Enum.HorizontalAlignment.Center,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 4)
        })
        
        create("UIPadding", {
            Parent = optionContainer,
            PaddingTop = UDim.new(0, 6)
        })

        function dropdown:SetValue(value)
            self.Value = value
            mainButton.Text = "  " .. text .. " - " .. value
            callback(value)
        end

        function dropdown:AddOption(option)
            local optionButton = create("TextButton", {
                Name = option,
                Parent = optionContainer,
                BackgroundColor3 = Color3.fromRGB(58, 69, 80),
                BackgroundTransparency = 0.75,
                BorderSizePixel = 0,
                Size = UDim2.new(0, 300, 0, 28),
                AutoButtonColor = false,
                Font = Enum.Font.GothamSemibold,
                Text = option,
                TextColor3 = WindUI.Theme.Text,
                TextSize = 14
            })
            
            create("UICorner", {
                CornerRadius = UDim.new(0, 6),
                Parent = optionButton
            })
            
            optionButton.MouseButton1Click:Connect(function()
                dropdown:SetValue(option)
                dropdown:Toggle()
            end)
        end

        function dropdown:Toggle()
            self.IsOpen = not self.IsOpen
            
            if self.IsOpen then
                optionContainer.Visible = true
                tween(optionContainer, {Size = UDim2.new(0, 312, 0, math.min(layout.AbsoluteContentSize.Y + 12, 200))}, 0.35, "Quint")
                openButton.Text = "-"
            else
                tween(optionContainer, {Size = UDim2.new(0, 312, 0, 0)}, 0.35, "Quint")
                task.wait(0.35)
                optionContainer.Visible = false
                openButton.Text = "+"
            end
        end

        -- 初始化选项
        for _, option in ipairs(options) do
            dropdown:AddOption(option)
        end

        mainButton.MouseButton1Click:Connect(function()
            dropdown:Toggle()
        end)

        -- 注册到全局
        WindUI.Flags[flag] = dropdown
        
        return dropdown
    end

    function tab:Textbox(text, placeholder, callback)
        callback = callback or function() end

        local button = create("TextButton", {
            Name = "Textbox",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = button
        })

        local textbox = create("TextBox", {
            Name = "InputBox",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(58, 69, 80),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Position = UDim2.new(0.775, 0, 0.179, 0),
            Size = UDim2.new(0, 65, 0, 18),
            Font = Enum.Font.Gotham,
            Text = "",
            PlaceholderText = placeholder,
            PlaceholderColor3 = Color3.fromRGB(200, 200, 200),
            TextColor3 = WindUI.Theme.Text,
            TextSize = 12
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = textbox
        })

        textbox.FocusLost:Connect(function(enterPressed)
            if enterPressed then
                callback(textbox.Text)
                textbox.Text = ""
            end
        end)

        return textbox
    end

    function tab:Keybind(text, defaultKey, callback)
        callback = callback or function() end
        
        local keybind = {
            Key = defaultKey or Enum.KeyCode.Unknown,
            Callback = callback
        }

        local button = create("TextButton", {
            Name = "Keybind",
            Parent = tab.Content,
            BackgroundColor3 = Color3.fromRGB(52, 62, 72),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Size = UDim2.new(0, 312, 0, 28),
            AutoButtonColor = false,
            Font = Enum.Font.GothamSemibold,
            Text = "  " .. text,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 6),
            Parent = button
        })

        local keyLabel = create("TextButton", {
            Name = "KeyLabel",
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(58, 69, 80),
            BackgroundTransparency = 0.75,
            BorderSizePixel = 0,
            Position = UDim2.new(0.75, 0, 0.179, 0),
            Size = UDim2.new(0, 74, 0, 18),
            Font = Enum.Font.Gotham,
            Text = keybind.Key.Name,
            TextColor3 = WindUI.Theme.Text,
            TextSize = 12
        })
        
        create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = keyLabel
        })

        local listening = false

        keyLabel.MouseButton1Click:Connect(function()
            listening = true
            keyLabel.Text = "..."
            
            local input = Services.UserInputService.InputEnded:Wait()
            if input.UserInputType == Enum.UserInputType.Keyboard then
                keybind.Key = input.KeyCode
                keyLabel.Text = input.KeyCode.Name
            end
            
            listening = false
        end)

        Services.UserInputService.InputBegan:Connect(function(input, gameProcessed)
            if not listening and not gameProcessed then
                if input.KeyCode == keybind.Key then
                    callback()
                end
            end
        end)

        return keybind
    end

    return tab
end

-- 通知系统
function WindUI:Notify(settings)
    settings = settings or {}
    
    local title = settings.title or "Notification"
    local text = settings.text or ""
    local duration = settings.duration or 5
    local type = settings.type or "default" -- default, success, error, warning

    local notification = create("Frame", {
        Name = "Notification",
        Parent = Services.CoreGui:FindFirstChild("WindUI_Notifications") or create("ScreenGui", {
            Name = "WindUI_Notifications",
            Parent = Services.CoreGui,
            ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
            ResetOnSpawn = false
        }),
        AnchorPoint = Vector2.new(1, 1),
        BackgroundColor3 = type == "success" and Color3.fromRGB(53, 255, 134) or 
                            type == "error" and Color3.fromRGB(255, 83, 83) or 
                            type == "warning" and Color3.fromRGB(255, 165, 0) or 
                            Color3.fromRGB(48, 48, 48),
        BorderSizePixel = 0,
        Position = UDim2.new(1, 300, 1, -10),
        Size = UDim2.new(0, 291, 0, 56)
    })
    
    create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = notification
    })
    
    create("UIStroke", {
        Parent = notification,
        Color = Color3.fromRGB(20, 20, 20),
        Thickness = 2,
        Transparency = 0.8
    })

    create("TextLabel", {
        Name = "Title",
        Parent = notification,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 19),
        Font = Enum.Font.SourceSans,
        Text = title,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    create("TextLabel", {
        Name = "Text",
        Parent = notification,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 0, 0.339, 0),
        Size = UDim2.new(1, 0, 0, 37),
        Font = Enum.Font.SourceSans,
        Text = text,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 14,
        TextYAlignment = Enum.TextYAlignment.Top,
        TextWrapped = true,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    create("UIPadding", {
        Parent = notification,
        PaddingLeft = UDim.new(0, 10),
        PaddingRight = UDim.new(0, 10)
    })

    -- 动画
    tween(notification, {Position = UDim2.new(1, -10, 1, -10)}, 0.5, "Quint", "Out")
    
    -- 自动隐藏
    task.delay(duration, function()
        tween(notification, {Position = UDim2.new(1, 300, 1, -10)}, 0.5, "Quint", "Out")
        task.wait(0.5)
        notification:Destroy()
    end)
end

-- 保存/加载系统
function WindUI:SaveConfig(name, data)
    name = name or "default"
    data = data or {}
    
    local config = {}
    for flag, component in pairs(self.Flags) do
        if component.Value ~= nil then
            config[flag] = component.Value
        elseif component.State ~= nil then
            config[flag] = component.State
        end
    end
    
    local encoded = HttpService:JSONEncode(config)
    writefile("WindUI/" .. name .. ".json", encoded)
end

function WindUI:LoadConfig(name)
    name = name or "default"
    
    local path = "WindUI/" .. name .. ".json"
    if isfile(path) then
        local content = readfile(path)
        local config = HttpService:JSONDecode(content)
        
        for flag, value in pairs(config) do
            local component = self.Flags[flag]
            if component then
                if component.SetValue then
                    component:SetValue(value)
                elseif component.SetState then
                    component:SetState(value)
                end
            end
        end
    else
        warn("Config not found: " .. name)
    end
end

-- 自动缩放
function WindUI:EnableAutoScale()
    local screenSize = Services.Workspace.CurrentCamera.ViewportSize
    local scale = math.min(screenSize.X / 1920, screenSize.Y / 1080)
    
    for _, window in ipairs(self.Windows or {}) do
        if window.MainFrame then
            window.MainFrame.Size = UDim2.new(0, 448 * scale, 0, 280 * scale)
        end
    end
end

-- 返回库
return WindUI