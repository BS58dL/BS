local Library = {}

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualUser = game:GetService("VirtualUser")

-- Local Player
local LocalPlayer = Players.LocalPlayer
local PlayerMouse = LocalPlayer:GetMouse()
local Workspace = game:GetService("Workspace")
local CurrentCamera = Workspace.CurrentCamera

-- UI Globals
local UDim = UDim.new
local UDim2 = UDim2.new
local Color3 = Color3.fromRGB
local InstanceNew = Instance.new
local TweenInfo = TweenInfo.new

-- Settings
local Settings = {
    Win = false,
    Rebirth = false
}

-- Create marker parts
local function CreateMarkers()
    local markers = {}
    
    local vipMarker = InstanceNew("Part", Workspace)
    vipMarker.Position = Vector3.new(-1860.61, -399.9, 927.21)
    vipMarker.Name = "Vip"
    vipMarker.Size = Vector3.new(0, 0.1, 0)
    vipMarker.Anchored = true
    vipMarker.Transparency = 1
    table.insert(markers, vipMarker)
    
    local labMarker = InstanceNew("Part", Workspace)
    labMarker.Position = Vector3.new(-1920.71, -399.9, 929.66)
    labMarker.Name = "Laaabby"
    labMarker.Size = Vector3.new(0, 0.1, 0)
    labMarker.Anchored = true
    labMarker.Transparency = 1
    table.insert(markers, labMarker)
    
    local gameMarker = InstanceNew("Part", Workspace)
    gameMarker.Position = Vector3.new(-0.81, 1, -7.31)
    gameMarker.Name = "Game"
    gameMarker.Size = Vector3.new(0, 0.1, 0)
    gameMarker.Anchored = true
    gameMarker.Transparency = 1
    table.insert(markers, gameMarker)
    
    return markers
end

-- Utility function to get player tycoon hash
local function GetTycoonHash()
    for _, descendant in pairs(Workspace.PlayerTycoons:GetDescendants()) do
        if descendant:IsA("ObjectValue") and descendant.Name == "Owner" then
            if tostring(descendant.Value) == LocalPlayer.Name then
                return descendant.Parent.Parent.Name
            end
        end
    end
    return nil
end

-- UI Library Core
Library.WindowName = "BS脚本"
Library.Flags = {}
Library.Modules = {}
Library.CurrentTab = nil
Library.Notifications = {}

-- Tween utility
Library.Tween = function(target, properties, duration, easingStyle, easingDirection)
    return TweenService:Create(target, TweenInfo.new(
        duration or 0.25,
        Enum.EasingStyle[easingStyle or "Linear"],
        Enum.EasingDirection[easingDirection or "InOut"]
    ), properties)
end

-- Tab switching
Library.SwitchTab = function(newTab)
    local oldTab = Library.CurrentTab
    if oldTab ~= newTab then
        Library.CurrentTab = newTab
        Library.Tween({Transparency = 1}, oldTab[2].Glow):Play()
        Library.Tween({Transparency = 0}, newTab[2].Glow):Play()
        oldTab[1].Visible = false
        newTab[1].Visible = true
    end
end

-- UI Creation
local ScreenGui = InstanceNew("ScreenGui")
ScreenGui.Name = Library.WindowName
ScreenGui.Parent = game:GetService("CoreGui")

-- Main Window
local MainWindow = InstanceNew("ImageLabel")
MainWindow.Name = "Main"
MainWindow.Parent = ScreenGui
MainWindow.BackgroundColor3 = Color3(52, 62, 72)
MainWindow.BorderSizePixel = 0
MainWindow.Position = UDim2(0.5, 0, 0.5, 0)
MainWindow.Size = UDim2(0, 448, 0, 280)
MainWindow.AnchorPoint = Vector2.new(0.5, 0.5)
MainWindow.Active = true
MainWindow.Draggable = true
MainWindow.Image = "rbxassetid://17281420682"

local MainCorner = InstanceNew("UICorner")
MainCorner.CornerRadius = UDim(0, 6)
MainCorner.Name = "MainCorner"
MainCorner.Parent = MainWindow

-- Title Bar
local TitleBar = InstanceNew("TextLabel")
TitleBar.Parent = MainWindow
TitleBar.BackgroundColor3 = Color3(25, 25, 25)
TitleBar.BorderSizePixel = 0
TitleBar.Position = UDim2(0, 6, 0, 6)
TitleBar.Size = UDim2(0, 436, 0, 24)
TitleBar.Font = Enum.Font.GothamBold
TitleBar.Text = "  " .. Library.WindowName
TitleBar.TextColor3 = Color3(255, 255, 255)
TitleBar.TextSize = 14
TitleBar.TextXAlignment = Enum.TextXAlignment.Left
TitleBar.BackgroundTransparency = 0.75

local TitleCorner = InstanceNew("UICorner")
TitleCorner.CornerRadius = UDim(0, 6)
TitleCorner.Name = "TextLabelCorner"
TitleCorner.Parent = TitleBar

-- Toggle Button
local ToggleButton = InstanceNew("TextButton")
ToggleButton.Name = "Open"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = MainWindow.BackgroundColor3
ToggleButton.Position = UDim2.new(0.839879155, 0, -0.0123076923, 0)
ToggleButton.BorderSizePixel = 2
ToggleButton.BorderColor3 = TitleBar.BackgroundColor3
ToggleButton.Size = UDim2.new(0, 55, 0, 25)
ToggleButton.Font = Enum.Font.SourceSans
ToggleButton.Text = "隐藏"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 14
ToggleButton.Active = true
ToggleButton.Draggable = true

local WindowVisible = true
ToggleButton.MouseButton1Down:Connect(function()
    WindowVisible = not WindowVisible
    MainWindow.Visible = WindowVisible
    ToggleButton.Text = WindowVisible and "隐藏" or "打开"
end)

-- Sidebar
local Sidebar = InstanceNew("Frame")
Sidebar.Name = "Sidebar"
Sidebar.Parent = MainWindow
Sidebar.BackgroundColor3 = Color3(58, 69, 80)
Sidebar.BorderSizePixel = 0
Sidebar.Position = UDim2(0, 6, 0, 36)
Sidebar.Size = UDim2(0, 106, 0, 238)
Sidebar.BackgroundTransparency = 0.75

local SidebarCorner = InstanceNew("UICorner")
SidebarCorner.CornerRadius = UDim(0, 6)
SidebarCorner.Name = "SidebarCorner"
SidebarCorner.Parent = Sidebar

-- Tab Buttons Container
local TabButtonsContainer = InstanceNew("ScrollingFrame")
TabButtonsContainer.Name = "TabButtons"
TabButtonsContainer.Parent = Sidebar
TabButtonsContainer.Active = true
TabButtonsContainer.BackgroundColor3 = Color3(255, 255, 255)
TabButtonsContainer.BackgroundTransparency = 1
TabButtonsContainer.BorderSizePixel = 0
TabButtonsContainer.Size = UDim2(0, 106, 0, 238)
TabButtonsContainer.ScrollBarThickness = 0

local TabButtonsLayout = InstanceNew("UIListLayout")
TabButtonsLayout.Parent = TabButtonsContainer
TabButtonsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
TabButtonsLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabButtonsLayout.Padding = UDim(0, 5)

local TabButtonsPadding = InstanceNew("UIPadding")
TabButtonsPadding.Parent = TabButtonsContainer
TabButtonsPadding.PaddingTop = UDim(0, 6)

-- Tab Content Area
local TabContentArea = InstanceNew("Frame")
TabContentArea.Name = "TabHolder"
TabContentArea.Parent = MainWindow
TabContentArea.BackgroundColor3 = Color3(58, 69, 80)
TabContentArea.BorderSizePixel = 0
TabContentArea.Position = UDim2(0, 118, 0, 36)
TabContentArea.Size = UDim2(0, 324, 0, 238)
TabContentArea.BackgroundTransparency = 0.75

local TabContentCorner = InstanceNew("UICorner")
TabContentCorner.CornerRadius = UDim(0, 6)
TabContentCorner.Name = "TabHolderCorner"
TabContentCorner.Parent = TabContentArea

-- Update container size
TabButtonsLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    TabButtonsContainer.CanvasSize = UDim2(0, 0, 0, TabButtonsLayout.AbsoluteContentSize.Y + 12)
end)

-- Notification system
local function CreateNotificationSystem()
    local notificationGui = InstanceNew("ScreenGui")
    notificationGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    local toggleNotification = InstanceNew("Frame")
    toggleNotification.Name = "ToggleNotif"
    toggleNotification.ZIndex = 5
    toggleNotification.AnchorPoint = Vector2.new(1, 1)
    toggleNotification.Visible = false
    toggleNotification.Size = UDim2.new(0, 291, 0, 56)
    toggleNotification.Position = UDim2.new(1, 0, 1, 0)
    toggleNotification.BackgroundColor3 = Color3.fromRGB(48, 48, 48)
    toggleNotification.Parent = notificationGui
    
    local defaultNotification = InstanceNew("Frame")
    defaultNotification.Name = "DefaultNotif"
    defaultNotification.ZIndex = 5
    defaultNotification.AnchorPoint = Vector2.new(1, 1)
    defaultNotification.Visible = false
    defaultNotification.Size = UDim2.new(0, 291, 0, 56)
    defaultNotification.Position = UDim2.new(1, 0, 0.9999999, 0)
    defaultNotification.BackgroundColor3 = Color3.fromRGB(48, 48, 48)
    defaultNotification.Parent = notificationGui
    
    if syn then
        syn.protect_gui(notificationGui)
    end
    notificationGui.Parent = LocalPlayer.PlayerGui
    return notificationGui
end

local NotificationHolder = CreateNotificationSystem()
local NotificationCount = 0
local LastRemovedPosition = nil

-- Notification functions
Library.SelectNotify = function(notificationData)
    local data = notificationData or {}
    data.TweenSpeed = data.TweenSpeed or 1
    data.TweenInSpeed = data.TweenInSpeed or data.TweenSpeed
    data.TweenOutSpeed = data.TweenOutSpeed or data.TweenSpeed
    data.TweenVerticalSpeed = data.TweenVerticalSpeed or data.TweenSpeed
    data.Title = data.Title or "Title"
    data.Text = data.Text or "Text"
    data.TrueText = data.TrueText or "Yes"
    data.FalseText = data.FalseText or "No"
    data.Duration = data.Duration or 5
    data.Callback = data.Callback or function()
        warn("No callback for notif")
    end
    
    NotificationCount = NotificationCount + 1
    local notif = NotificationHolder.ToggleNotif:Clone()
    notif.Parent = NotificationHolder
    notif.Visible = true
    notif.Position = UDim2.new(1, 300, 1, -5)
    notif.Transparency = 0.05
    notif.True.Text = data.TrueText
    notif.False.Text = data.FalseText
    
    notif.True.MouseButton1Click:Connect(function()
        pcall(data.Callback, true)
        notif:Destroy()
    end)
    
    notif.False.MouseButton1Click:Connect(function()
        pcall(data.Callback, false)
        notif:Destroy()
    end)
    
    notif.Paragraph.Text = data.Text
    notif.Title.Text = data.Title
    notif:TweenPosition(UDim2.new(1, -5, 1, -5), Enum.EasingDirection.Out, Enum.EasingStyle.Quint, data.TweenInSpeed)
end

Library.Notify = function(notificationData)
    local data = notificationData or {}
    data.TweenSpeed = data.TweenSpeed or 1
    data.TweenInSpeed = data.TweenInSpeed or data.TweenSpeed
    data.TweenOutSpeed = data.TweenOutSpeed or data.TweenSpeed
    data.TweenVerticalSpeed = data.TweenVerticalSpeed or data.TweenSpeed
    data.Title = data.Title or "Title"
    data.Text = data.Text or "Text"
    data.Duration = data.Duration or 5
    
    NotificationCount = NotificationCount + 1
    local notif = NotificationHolder.DefaultNotif:Clone()
    notif.Parent = NotificationHolder
    notif.Visible = true
    notif.Position = UDim2.new(1, 300, 1, -5)
    notif.Transparency = 0.05
    
    notif.Paragraph.Text = data.Text
    notif.Title.Text = data.Title
    notif:TweenPosition(UDim2.new(1, -5, 1, -5), Enum.EasingDirection.Out, Enum.EasingStyle.Quint, data.TweenInSpeed)
    
    task.spawn(function()
        wait(data.Duration)
        notif:TweenPosition(UDim2.new(1, 300, 1, -5), Enum.EasingDirection.Out, Enum.EasingStyle.Quint, data.TweenOutSpeed)
        wait(data.TweenOutSpeed)
        notif:Destroy()
    end)
end

-- Tab creation
Library.CreateTab = function(tabName)
    local tabButton = InstanceNew("TextButton")
    local tabContent = InstanceNew("ScrollingFrame")
    
    -- Tab Button
    tabButton.Name = "TabButton"
    tabButton.Parent = TabButtonsContainer
    tabButton.BackgroundColor3 = Color3(52, 62, 72)
    tabButton.BorderSizePixel = 0
    tabButton.Size = UDim2(0, 94, 0, 28)
    tabButton.AutoButtonColor = false
    tabButton.Font = Enum.Font.GothamSemibold
    tabButton.Text = tabName
    tabButton.TextColor3 = Color3(255, 255, 255)
    tabButton.TextSize = 14
    tabButton.BackgroundTransparency = 0.75
    
    local tabButtonCorner = InstanceNew("UICorner")
    tabButtonCorner.CornerRadius = UDim(0, 6)
    tabButtonCorner.Name = "TabButtonCorner"
    tabButtonCorner.Parent = tabButton
    
    local glowIndicator = InstanceNew("Frame")
    glowIndicator.Name = "Glow"
    glowIndicator.Parent = tabButton
    glowIndicator.BackgroundColor3 = Color3(255, 255, 255)
    glowIndicator.BorderSizePixel = 0
    glowIndicator.Position = UDim2(0, 0, 0.928571463, 0)
    glowIndicator.Size = UDim2(0, 94, 0, 2)
    glowIndicator.Transparency = 1
    
    -- Tab Content
    tabContent.Name = "Tab"
    tabContent.Parent = TabContentArea
    tabContent.Active = true
    tabContent.BackgroundColor3 = Color3(255, 255, 255)
    tabContent.BackgroundTransparency = 1
    tabContent.BorderSizePixel = 0
    tabContent.Size = UDim2(0, 324, 0, 238)
    tabContent.ScrollBarThickness = 0
    tabContent.Visible = false
    
    local tabLayout = InstanceNew("UIListLayout")
    tabLayout.Name = "TabLayout"
    tabLayout.Parent = tabContent
    tabLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    tabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabLayout.Padding = UDim(0, 5)
    
    local tabPadding = InstanceNew("UIPadding")
    tabPadding.Name = "TabPadding"
    tabPadding.Parent = tabContent
    tabPadding.PaddingTop = UDim(0, 6)
    
    -- Set first tab as default
    if not Library.CurrentTab then
        Library.CurrentTab = {tabContent, tabButton}
        glowIndicator.Transparency = 0
        tabContent.Visible = true
    end
    
    -- Update content size
    tabLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        tabContent.CanvasSize = UDim2(0, 0, 0, tabLayout.AbsoluteContentSize.Y + 12)
    end)
    
    -- Tab switching
    tabButton.MouseButton1Click:Connect(function()
        Library.SwitchTab({tabContent, tabButton})
    end)
    
    -- Return UI elements builder
    return {
        -- Add separator
        Separator = function()
            local separator = InstanceNew("Frame")
            separator.Transparency = 1
            separator.Size = UDim2(0, 0, 0, 0)
            separator.BorderSizePixel = 0
            separator.Parent = tabContent
        end,
        
        -- Add button
        Button = function(buttonText, callback)
            local button = InstanceNew("TextButton")
            button.Name = "BtnModule"
            button.Parent = tabContent
            button.BackgroundColor3 = Color3(52, 62, 72)
            button.BorderSizePixel = 0
            button.Size = UDim2(0, 312, 0, 28)
            button.AutoButtonColor = false
            button.Font = Enum.Font.GothamSemibold
            button.Text = "  " .. buttonText
            button.TextColor3 = Color3(255, 255, 255)
            button.TextSize = 14
            button.TextXAlignment = Enum.TextXAlignment.Left
            button.BackgroundTransparency = 0.75
            
            local buttonCorner = InstanceNew("UICorner")
            buttonCorner.CornerRadius = UDim(0, 6)
            buttonCorner.Name = "BtnModuleCorner"
            buttonCorner.Parent = button
            
            if callback then
                button.MouseButton1Click:Connect(callback)
            end
        end,
        
        -- Add toggle
        Toggle = function(toggleName, flagName, defaultValue, callback)
            local toggleState = defaultValue or false
            
            local toggleContainer = InstanceNew("TextButton")
            toggleContainer.Name = "ToggleModule"
            toggleContainer.Parent = tabContent
            toggleContainer.BackgroundColor3 = Color3(52, 62, 72)
            toggleContainer.BorderSizePixel = 0
            toggleContainer.Size = UDim2(0, 312, 0, 28)
            toggleContainer.AutoButtonColor = false
            toggleContainer.Font = Enum.Font.GothamSemibold
            toggleContainer.Text = "  " .. toggleName
            toggleContainer.TextColor3 = Color3(255, 255, 255)
            toggleContainer.TextSize = 14
            toggleContainer.TextXAlignment = Enum.TextXAlignment.Left
            toggleContainer.BackgroundTransparency = 0.75
            
            local toggleCorner = InstanceNew("UICorner")
            toggleCorner.CornerRadius = UDim(0, 6)
            toggleCorner.Name = "ToggleModuleCorner"
            toggleCorner.Parent = toggleContainer
            
            -- Off state indicator
            local offIndicator = InstanceNew("Frame")
            offIndicator.Name = "OffStatus"
            offIndicator.Parent = toggleContainer
            offIndicator.BackgroundColor3 = Color3(255, 255, 255)
            offIndicator.BorderSizePixel = 0
            offIndicator.Position = UDim2(0.878205061, 0, 0.178571433, 0)
            offIndicator.Size = UDim2(0, 34, 0, 18)
            
            -- On state indicator
            local onIndicator = InstanceNew("Frame")
            onIndicator.Name = "OnStatus"
            onIndicator.Parent = toggleContainer
            onIndicator.BackgroundColor3 = Color3(255, 255, 255)
            onIndicator.BackgroundTransparency = 1
            onIndicator.BorderSizePixel = 0
            onIndicator.Position = UDim2(0.878205121, 0, 0.178571433, 0)
            onIndicator.Size = UDim2(0, 34, 0, 18)
            onIndicator.Transparency = 1
            
            -- Store in flags
            Library.Flags[flagName or toggleName] = {
                State = toggleState,
                Callback = callback or function() end,
                SetState = function(newState)
                    if newState == nil then
                        newState = not Library.Flags[flagName or toggleName].State
                    end
                    Library.Flags[flagName or toggleName].State = newState
                    if callback then callback(newState) end
                    
                    -- Update visual state
                    Library.Tween({Transparency = newState and 1 or 0}, offIndicator):Play()
                    Library.Tween({Transparency = newState and 0 or 1}, onIndicator):Play()
                end
            }
            
            -- Click handler
            toggleContainer.MouseButton1Click:Connect(function()
                Library.Flags[flagName or toggleName]:SetState()
            end)
            
            -- Set initial state
            if defaultValue then
                Library.Flags[flagName or toggleName]:SetState(defaultValue)
            end
        end,
        
        -- Add keybind
        NewBind = function(keybindName, defaultKey, callback)
            local currentKey = Enum.KeyCode[defaultKey]
            local keyName = defaultKey or "None"
            
            local keybindContainer = InstanceNew("TextButton")
            keybindContainer.Name = "KeybindModule"
            keybindContainer.Parent = tabContent
            keybindContainer.BackgroundColor3 = Color3(52, 62, 72)
            keybindContainer.BorderSizePixel = 0
            keybindContainer.Size = UDim2(0, 312, 0, 28)
            keybindContainer.AutoButtonColor = false
            keybindContainer.Font = Enum.Font.GothamSemibold
            keybindContainer.Text = "  " .. keybindName
            keybindContainer.TextColor3 = Color3(255, 255, 255)
            keybindContainer.TextSize = 14
            keybindContainer.TextXAlignment = Enum.TextXAlignment.Left
            
            local keybindCorner = InstanceNew("UICorner")
            keybindCorner.CornerRadius = UDim(0, 6)
            keybindCorner.Name = "KeybindModuleCorner"
            keybindCorner.Parent = keybindContainer
            
            local keyDisplay = InstanceNew("TextButton")
            keyDisplay.Name = "KeybindValue"
            keyDisplay.Parent = keybindContainer
            keyDisplay.BackgroundColor3 = Color3(58, 69, 80)
            keyDisplay.BorderSizePixel = 0
            keyDisplay.Position = UDim2(0.75, 0, 0.178571433, 0)
            keyDisplay.Size = UDim2(0, 74, 0, 18)
            keyDisplay.AutoButtonColor = false
            keyDisplay.Font = Enum.Font.Gotham
            keyDisplay.Text = keyName
            keyDisplay.TextColor3 = Color3(255, 255, 255)
            keyDisplay.TextSize = 12
            
            local keyDisplayCorner = InstanceNew("UICorner")
            keyDisplayCorner.CornerRadius = UDim(0, 4)
            keyDisplayCorner.Name = "KeybindValueCorner"
            keyDisplayCorner.Parent = keyDisplay
            
            -- Key detection
            UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if not gameProcessed and input.UserInputType == Enum.UserInputType.Keyboard then
                    if input.KeyCode == currentKey then
                        callback(keyName)
                    end
                end
            end)
            
            -- Rebind functionality
            keyDisplay.MouseButton1Click:Connect(function()
                keyDisplay.Text = "..."
                local input = UserInputService.InputEnded:Wait()
                
                if input.UserInputType == Enum.UserInputType.Keyboard then
                    local newKey = input.KeyCode.Name
                    currentKey = Enum.KeyCode[newKey]
                    keyDisplay.Text = newKey
                else
                    keyDisplay.Text = keyName
                end
            end)
        end,
        
        -- Add slider
        Slider = function(sliderName, flagName, defaultValue, minValue, maxValue, decimal, callback)
            local currentValue = defaultValue or minValue
            
            local sliderContainer = InstanceNew("TextButton")
            sliderContainer.Name = "SliderModule"
            sliderContainer.Parent = tabContent
            sliderContainer.BackgroundColor3 = Color3(52, 62, 72)
            sliderContainer.BorderSizePixel = 0
            sliderContainer.Size = UDim2(0, 312, 0, 28)
            sliderContainer.AutoButtonColor = false
            sliderContainer.Font = Enum.Font.GothamSemibold
            sliderContainer.Text = "  " .. sliderName
            sliderContainer.TextColor3 = Color3(255, 255, 255)
            sliderContainer.TextSize = 14
            sliderContainer.TextXAlignment = Enum.TextXAlignment.Left
            sliderContainer.BackgroundTransparency = 0.75
            
            local sliderCorner = InstanceNew("UICorner")
            sliderCorner.CornerRadius = UDim(0, 6)
            sliderCorner.Name = "SliderModuleCorner"
            sliderCorner.Parent = sliderContainer
            
            -- Slider track
            local sliderTrack = InstanceNew("Frame")
            sliderTrack.Name = "SliderBar"
            sliderTrack.Parent = sliderContainer
            sliderTrack.BackgroundColor3 = Color3(58, 69, 80)
            sliderTrack.BackgroundTransparency = 0.75
            sliderTrack.BorderSizePixel = 0
            sliderTrack.Position = UDim2(0.442307681, 0, 0.392857134, 0)
            sliderTrack.Size = UDim2(0, 108, 0, 6)
            
            -- Slider fill
            local sliderFill = InstanceNew("Frame")
            sliderFill.Name = "SliderPart"
            sliderFill.Parent = sliderTrack
            sliderFill.BackgroundColor3 = Color3(255, 255, 255)
            sliderFill.BorderSizePixel = 0
            sliderFill.Size = UDim2(0, 0, 0, 6)
            
            -- Value display
            local valueBox = InstanceNew("TextBox")
            valueBox.Name = "SliderValue"
            valueBox.Parent = sliderContainer
            valueBox.BackgroundColor3 = Color3(58, 69, 80)
            valueBox.BackgroundTransparency = 0.75
            valueBox.BorderSizePixel = 0
            valueBox.Position = UDim2(0.884615362, 0, 0.178571433, 0)
            valueBox.Size = UDim2(0, 32, 0, 18)
            valueBox.Font = Enum.Font.Gotham
            valueBox.Text = tostring(currentValue)
            valueBox.TextColor3 = Color3(255, 255, 255)
            valueBox.TextSize = 12
            
            -- Value adjustment functions
            Library.Flags[flagName] = {
                State = currentValue,
                SetValue = function(newValue)
                    local percentage
                    if newValue then
                        percentage = (newValue - minValue) / (maxValue - minValue)
                    else
                        local mousePos = PlayerMouse.X
                        local trackPos = sliderTrack.AbsolutePosition.X
                        local trackSize = sliderTrack.AbsoluteSize.X
                        percentage = math.clamp((mousePos - trackPos) / trackSize, 0, 1)
                    end
                    
                    local rawValue = minValue + (maxValue - minValue) * percentage
                    local finalValue
                    
                    if decimal then
                        finalValue = tonumber(string.format("%.1f", rawValue))
                    else
                        finalValue = math.floor(rawValue)
                    end
                    
                    finalValue = math.clamp(finalValue, minValue, maxValue)
                    
                    Library.Flags[flagName].State = finalValue
                    valueBox.Text = tostring(finalValue)
                    sliderFill.Size = UDim2(percentage, 0, 0, 6)
                    
                    if callback then callback(finalValue) end
                end
            }
            
            -- Initialize
            Library.Flags[flagName]:SetValue(currentValue)
            
            -- Slider interaction
            local isDragging = false
            sliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    isDragging = true
                    Library.Flags[flagName]:SetValue()
                end
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    isDragging = false
                end
            end)
            
            UserInputService.InputChanged:Connect(function()
                if isDragging then
                    Library.Flags[flagName]:SetValue()
                end
            end)
        end,
        
        -- Add dropdown
        Dropdown = function(dropdownName, flagName, options, callback)
            local currentOption = options[1] or ""
            
            local dropdownContainer = InstanceNew("TextButton")
            dropdownContainer.Name = "DropdownModule"
            dropdownContainer.Parent = tabContent
            dropdownContainer.BackgroundColor3 = Color3(52, 62, 72)
            dropdownContainer.BorderSizePixel = 0
            dropdownContainer.Size = UDim2(0, 312, 0, 28)
            dropdownContainer.AutoButtonColor = false
            dropdownContainer.Font = Enum.Font.GothamSemibold
            dropdownContainer.Text = ""
            dropdownContainer.TextColor3 = Color3(255, 255, 255)
            dropdownContainer.TextSize = 14
            dropdownContainer.TextXAlignment = Enum.TextXAlignment.Left
            dropdownContainer.BackgroundTransparency = 0.75
            
            local dropdownCorner = InstanceNew("UICorner")
            dropdownCorner.CornerRadius = UDim(0, 6)
            dropdownCorner.Name = "DropdownModuleCorner"
            dropdownCorner.Parent = dropdownContainer
            
            -- Dropdown text
            local dropdownText = InstanceNew("TextBox")
            dropdownText.Name = "DropdownText"
            dropdownText.Parent = dropdownContainer
            dropdownText.BackgroundColor3 = Color3(255, 255, 255)
            dropdownText.BackgroundTransparency = 1
            dropdownText.Position = UDim2(0.025641026, 0, 0, 0)
            dropdownText.Size = UDim2(0, 192, 0, 28)
            dropdownText.Font = Enum.Font.GothamSemibold
            dropdownText.PlaceholderText = dropdownName
            dropdownText.PlaceholderColor3 = Color3(255, 255, 255)
            dropdownText.TextColor3 = Color3(255, 255, 255)
            dropdownText.TextSize = 14
            dropdownText.TextXAlignment = Enum.TextXAlignment.Left
            dropdownText.Text = ""
            
            -- Dropdown toggle button
            local toggleButton = InstanceNew("TextButton")
            toggleButton.Name = "OpenDropdown"
            toggleButton.Parent = dropdownContainer
            toggleButton.BackgroundColor3 = Color3(255, 255, 255)
            toggleButton.BackgroundTransparency = 1
            toggleButton.BorderSizePixel = 0
            toggleButton.Position = UDim2(0.907051265, 0, 0.178571433, 0)
            toggleButton.Size = UDim2(0, 18, 0, 18)
            toggleButton.Font = Enum.Font.Gotham
            toggleButton.Text = "+"
            toggleButton.TextColor3 = Color3(255, 255, 255)
            toggleButton.TextSize = 22
            
            -- Dropdown options container
            local optionsContainer = InstanceNew("Frame")
            optionsContainer.Name = "DropdownBottom"
            optionsContainer.Parent = tabContent
            optionsContainer.BackgroundColor3 = Color3(52, 62, 72)
            optionsContainer.BackgroundTransparency = 0.75
            optionsContainer.BorderSizePixel = 0
            optionsContainer.ClipsDescendants = true
            optionsContainer.Size = UDim2(0, 312, 0, 0)
            optionsContainer.Visible = false
            
            local optionsLayout = InstanceNew("UIListLayout")
            optionsLayout.Parent = optionsContainer
            optionsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
            optionsLayout.SortOrder = Enum.SortOrder.LayoutOrder
            optionsLayout.Padding = UDim(0, 6)
            
            local optionsPadding = InstanceNew("UIPadding")
            optionsPadding.Parent = optionsContainer
            optionsPadding.PaddingTop = UDim(0, 6)
            
            -- Dropdown functionality
            local isOpen = false
            
            local function ToggleDropdown()
                isOpen = not isOpen
                optionsContainer.Visible = isOpen
                toggleButton.Text = isOpen and "-" or "+"
                
                if isOpen then
                    Library.Tween({Size = UDim2(0, 312, 0, optionsLayout.AbsoluteContentSize.Y + 12)}, optionsContainer, 0.35):Play()
                else
                    Library.Tween({Size = UDim2(0, 312, 0, 0)}, optionsContainer, 0.35):Play()
                end
            end
            
            toggleButton.MouseButton1Click:Connect(ToggleDropdown)
            
            -- Add options
            Library.Flags[flagName] = {
                State = currentOption,
                SetOptions = function(newOptions)
                    -- Clear existing options
                    for _, child in pairs(optionsContainer:GetChildren()) do
                        if child:IsA("TextButton") then
                            child:Destroy()
                        end
                    end
                    
                    -- Add new options
                    for _, option in ipairs(newOptions) do
                        local optionButton = InstanceNew("TextButton")
                        optionButton.Name = option
                        optionButton.Parent = optionsContainer
                        optionButton.BackgroundColor3 = Color3(58, 69, 80)
                        optionButton.BackgroundTransparency = 0.75
                        optionButton.BorderSizePixel = 0
                        optionButton.Size = UDim2(0, 300, 0, 28)
                        optionButton.AutoButtonColor = false
                        optionButton.Font = Enum.Font.GothamSemibold
                        optionButton.Text = option
                        optionButton.TextColor3 = Color3(255, 255, 255)
                        optionButton.TextSize = 14
                        
                        optionButton.MouseButton1Click:Connect(function()
                            dropdownText.PlaceholderText = option
                            dropdownText.Text = ""
                            Library.Flags[flagName].State = option
                            ToggleDropdown()
                            if callback then callback(option) end
                        end)
                    end
                end,
                ClearOptions = function()
                    for _, child in pairs(optionsContainer:GetChildren()) do
                        if child:IsA("TextButton") then
                            child:Destroy()
                        end
                    end
                end,
                AddOption = function(option)
                    local optionButton = InstanceNew("TextButton")
                    optionButton.Name = option
                    optionButton.Parent = optionsContainer
                    optionButton.BackgroundColor3 = Color3(58, 69, 80)
                    optionButton.BackgroundTransparency = 0.75
                    optionButton.BorderSizePixel = 0
                    optionButton.Size = UDim2(0, 300, 0, 28)
                    optionButton.AutoButtonColor = false
                    optionButton.Font = Enum.Font.GothamSemibold
                    optionButton.Text = option
                    optionButton.TextColor3 = Color3(255, 255, 255)
                    optionButton.TextSize = 14
                    
                    optionButton.MouseButton1Click:Connect(function()
                        dropdownText.PlaceholderText = option
                        dropdownText.Text = ""
                        Library.Flags[flagName].State = option
                        ToggleDropdown()
                        if callback then callback(option) end
                    end)
                end,
                RemoveOption = function(option)
                    local optionButton = optionsContainer:FindFirstChild(option)
                    if optionButton then
                        optionButton:Destroy()
                    end
                end
            }
            
            -- Initialize options
            Library.Flags[flagName]:SetOptions(options)
        end,
        
        -- Add textbox
        Textbox = function(textboxName, placeholder, callback)
            local textboxContainer = InstanceNew("TextButton")
            textboxContainer.Name = "TextboxModule"
            textboxContainer.Parent = tabContent
            textboxContainer.BackgroundColor3 = Color3(52, 62, 72)
            textboxContainer.BackgroundTransparency = 0.75
            textboxContainer.BorderSizePixel = 0
            textboxContainer.Size = UDim2(0, 312, 0, 28)
            textboxContainer.AutoButtonColor = false
            textboxContainer.Font = Enum.Font.GothamSemibold
            textboxContainer.Text = "  " .. textboxName
            textboxContainer.TextColor3 = Color3(255, 255, 255)
            textboxContainer.TextSize = 14
            textboxContainer.TextXAlignment = Enum.TextXAlignment.Left
            
            local textboxCorner = InstanceNew("UICorner")
            textboxCorner.CornerRadius = UDim(0, 6)
            textboxCorner.Name = "BoxButtonCorner"
            textboxCorner.Parent = textboxContainer
            
            local inputBox = InstanceNew("TextBox")
            inputBox.Name = "Box"
            inputBox.Parent = textboxContainer
            inputBox.BackgroundColor3 = Color3(58, 69, 80)
            inputBox.BackgroundTransparency = 0.75
            inputBox.BorderSizePixel = 0
            inputBox.Position = UDim2(0.774615362, 0, 0.178571433, 0)
            inputBox.Size = UDim2(0, 65, 0, 18)
            inputBox.Font = Enum.Font.Gotham
            inputBox.Text = ""
            inputBox.PlaceholderText = placeholder
            inputBox.TextColor3 = Color3(255, 255, 255)
            inputBox.TextSize = 12
            
            local inputCorner = InstanceNew("UICorner")
            inputCorner.CornerRadius = UDim(0, 4)
            inputCorner.Name = "BoxCorner"
            inputCorner.Parent = inputBox
            
            inputBox.FocusLost:Connect(function(enterPressed)
                if enterPressed then
                    if callback then callback(inputBox.Text) end
                    inputBox.Text = ""
                end
            end)
        end
    }
end

-- Initialize
CreateMarkers()
ShowStartupMessages()

-- Return library for external use
return Library