repeat task.wait() until game:IsLoaded()

local library = {}
library.currentTab = nil
library.flags   = {}

local configPath = "BS脚本/UI配置.txt"

local function saveConfig(config)
	local ok, json = pcall(game.HttpService.JSONEncode, game:GetService("HttpService"), config)
	if not ok then return end
	if not isfolder("BS脚本") then makefolder("BS脚本") end
	if isfile(configPath) then delfile(configPath) end
	writefile(configPath, json)
end

local function loadConfig()
	if not isfile(configPath) then
		return { autoFitScreen = false, windowSize = {650,400}, windowPosition = {0.5,0.5} }
	end
	local ok, cfg = pcall(game.HttpService.JSONDecode, game:GetService("HttpService"), readfile(configPath))
	return ok and cfg or { autoFitScreen = false, windowSize = {650,400}, windowPosition = {0.5,0.5} }
end

local services = setmetatable({}, {__index = function(t,k) return game:GetService(k) end})
local mouse = services.Players.LocalPlayer:GetMouse()

local Colors = {
	Primary     = Color3.fromRGB(15,15,15),
	Secondary   = Color3.fromRGB(30,30,30),
	Accent      = Color3.fromRGB(52,152,219),
	Text        = Color3.fromRGB(240,240,240),
	Placeholder = Color3.fromRGB(150,150,150),
	White       = Color3.fromRGB(255,255,255),
	Transparent = 0.25
}

local function CreateGlassEffect(obj, t)
	obj.BackgroundTransparency = t or Colors.Transparent
	if obj:FindFirstChild("GlassEffect") then return end
	local g = Instance.new("ImageLabel")
	g.Name = "GlassEffect"
	g.BackgroundTransparency = 1
	g.Size = UDim2.new(1,0,1,0)
	g.Image = "rbxassetid://5554237735"
	g.ImageTransparency = 0.95
	g.Parent = obj
end

local function Tween(obj, t, style, dir, data)
	services.TweenService:Create(obj, TweenInfo.new(t, Enum.EasingStyle[style], Enum.EasingDirection[dir]), data):Play()
end

local function Ripple(obj)
	spawn(function()
		obj.ClipsDescendants = true
		local r = Instance.new("ImageLabel")
		r.Name = "Ripple"
		r.Parent = obj
		r.BackgroundTransparency = 1
		r.ZIndex = 8
		r.Image = "rbxassetid://2708891598"
		r.ImageTransparency = 0.8
		r.ScaleType = Enum.ScaleType.Fit
		r.ImageColor3 = Colors.White
		r.Position = UDim2.new((mouse.X - r.AbsolutePosition.X)/obj.AbsoluteSize.X, 0, (mouse.Y - r.AbsolutePosition.Y)/obj.AbsoluteSize.Y, 0)
		Tween(r, 0.3, "Linear", "InOut", {Position = UDim2.new(-5.5,0,-5.5,0), Size = UDim2.new(12,0,12,0)})
		wait(0.15)
		Tween(r, 0.3, "Linear", "InOut", {ImageTransparency = 1})
		wait(0.3)
		r:Destroy()
	end)
end

local function autoFitUIScreen(f)
	local v = services.Workspace.CurrentCamera.ViewportSize
	if v.X < 800 then f.Size = UDim2.new(0, v.X - 100, 0, v.Y - 100)
	elseif v.Y < 600 then f.Size = UDim2.new(0, 550, 0, v.Y - 100)
	else f.Size = UDim2.new(0, 650, 0, 400) end
	f.Position = UDim2.new(0.5, 0, 0.5, 0)
end

local function drag(f, h)
	if not h then h = f end
	local d, di, ds, sp
	local function upd(i) local dt = i.Position - ds; f.Position = UDim2.new(sp.X.Scale, sp.X.Offset + dt.X, sp.Y.Scale, sp.Y.Offset + dt.Y) end
	h.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1 then
			d = true; ds = i.Position; sp = f.Position
			i.Changed:Connect(function() if i.UserInputState == Enum.UserInputState.End then d = false end end)
		end
	end)
	f.InputChanged:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseMovement then di = i end end)
	services.UserInputService.InputChanged:Connect(function(i) if i == di and d then upd(i) end end)
end

function library.new(lib, name)
	for _, v in ipairs(services.CoreGui:GetChildren()) do if v.Name == "REN" then v:Destroy() end end
	local gui = Instance.new("ScreenGui")
	gui.Name = "REN"
	gui.Parent = services.CoreGui
	if syn and syn.protect_gui then syn.protect_gui(gui) end

	local main = Instance.new("Frame")
	main.Name = "Main"
	main.Parent = gui
	main.AnchorPoint = Vector2.new(0.5, 0.5)
	main.BackgroundColor3 = Colors.Primary
	main.Size = UDim2.new(0, 650, 0, 400)
	main.Position = UDim2.new(0.5, 0, 0.5, 0)
	main.ZIndex = 1
	main.Active = true
	main.Draggable = true
	CreateGlassEffect(main)
	local mainC = Instance.new("UICorner"); mainC.CornerRadius = UDim.new(0, 8); mainC.Parent = main
	local mainS = Instance.new("UIStroke"); mainS.Color = Colors.Secondary; mainS.Thickness = 1; mainS.Transparency = 0.5; mainS.Parent = main

	local shadow = Instance.new("ImageLabel")
	shadow.Name = "DropShadow"
	shadow.Parent = Instance.new("Frame", main)
	shadow.AnchorPoint = Vector2.new(0.5, 0.5)
	shadow.BackgroundTransparency = 1
	shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
	shadow.Size = UDim2.new(1, 47, 1, 47)
	shadow.ZIndex = 0
	shadow.Image = "rbxassetid://6015897843"
	shadow.ImageColor3 = Colors.Primary
	shadow.ImageTransparency = 0.7
	shadow.ScaleType = Enum.ScaleType.Slice
	shadow.SliceCenter = Rect.new(49, 49, 450, 450)

	local cfg = loadConfig()
	local autoFit = cfg.autoFitScreen
	if autoFit then autoFitUIScreen(main) end

	local autoBtn = Instance.new("ImageButton")
	autoBtn.Name = "AutoFitBtn"
	autoBtn.Parent = main
	autoBtn.BackgroundColor3 = Colors.Secondary
	autoBtn.BackgroundTransparency = 0.3
	autoBtn.Position = UDim2.new(1, -95, 0, 10)
	autoBtn.Size = UDim2.new(0, 25, 0, 25)
	autoBtn.Image = "rbxassetid://3926305904"
	autoBtn.ImageRectOffset = Vector2.new(244, 164)
	autoBtn.ImageRectSize = Vector2.new(36, 36)
	autoBtn.ImageColor3 = autoFit and Colors.Accent or Colors.Text
	autoBtn.ZIndex = 10
	CreateGlassEffect(autoBtn)
	local autoBtnC = Instance.new("UICorner"); autoBtnC.CornerRadius = UDim.new(0, 6); autoBtnC.Parent = autoBtn

	local scaleBtn = Instance.new("ImageButton")
	scaleBtn.Name = "ScaleBtn"
	scaleBtn.Parent = main
	scaleBtn.BackgroundColor3 = Colors.Secondary
	scaleBtn.BackgroundTransparency = 0.3
	scaleBtn.Position = UDim2.new(1, -65, 0, 10)
	scaleBtn.Size = UDim2.new(0, 25, 0, 25)
	scaleBtn.Image = "rbxassetid://3926305904"
	scaleBtn.ImageRectOffset = Vector2.new(324, 364)
	scaleBtn.ImageRectSize = Vector2.new(36, 36)
	scaleBtn.ImageColor3 = Colors.Text
	scaleBtn.ZIndex = 10
	CreateGlassEffect(scaleBtn)
	local scaleBtnC = Instance.new("UICorner"); scaleBtnC.CornerRadius = UDim.new(0, 6); scaleBtnC.Parent = scaleBtn

	local closeBtn = Instance.new("TextButton")
	closeBtn.Name = "CloseBtn"
	closeBtn.Parent = main
	closeBtn.BackgroundColor3 = Colors.Secondary
	closeBtn.BackgroundTransparency = 0.3
	closeBtn.Position = UDim2.new(1, -35, 0, 10)
	closeBtn.Size = UDim2.new(0, 25, 0, 25)
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.Text = "×"
	closeBtn.TextColor3 = Colors.Text
	closeBtn.TextSize = 20
	closeBtn.ZIndex = 10
	local closeBtnC = Instance.new("UICorner"); closeBtnC.CornerRadius = UDim.new(0, 6); closeBtnC.Parent = closeBtn
	closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

	local scaleOn = false
	autoBtn.MouseButton1Click:Connect(function()
		Ripple(autoBtn)
		autoFit = not autoFit
		if autoFit then
			autoFitUIScreen(main)
			Tween(autoBtn, 0.2, "Sine", "Out", {ImageColor3 = Colors.Accent})
			Tween(autoBtn, 0.2, "Sine", "Out", {BackgroundTransparency = 0})
		else
			main.Size = UDim2.new(0, 650, 0, 400); main.Position = UDim2.new(0.5, 0, 0.5, 0)
			Tween(autoBtn, 0.2, "Sine", "Out", {ImageColor3 = Colors.Text})
			Tween(autoBtn, 0.2, "Sine", "Out", {BackgroundTransparency = 0.3})
		end
		cfg.autoFitScreen = autoFit; saveConfig(cfg)
	end)

	scaleBtn.MouseButton1Click:Connect(function()
		Ripple(scaleBtn)
		scaleOn = not scaleOn
		if scaleOn then
			main.Size = UDim2.new(0, 325, 0, 200); main.Position = UDim2.new(0.5, 0, 0.5, 0)
			Tween(scaleBtn, 0.2, "Sine", "Out", {ImageColor3 = Colors.Accent})
			Tween(scaleBtn, 0.2, "Sine", "Out", {BackgroundTransparency = 0})
		else
			main.Size = UDim2.new(0, 650, 0, 400); main.Position = UDim2.new(0.5, 0, 0.5, 0)
			Tween(scaleBtn, 0.2, "Sine", "Out", {ImageColor3 = Colors.Text})
			Tween(scaleBtn, 0.2, "Sine", "Out", {BackgroundTransparency = 0.3})
		end
	end)

	local titleBar = Instance.new("Frame")
	titleBar.Name = "TitleBar"
	titleBar.Parent = main
	titleBar.BackgroundColor3 = Colors.Secondary
	titleBar.BackgroundTransparency = Colors.Transparent
	titleBar.Size = UDim2.new(1, 0, 0, 45)
	local titleBarC = Instance.new("UICorner"); titleBarC.CornerRadius = UDim.new(0, 8); titleBarC.Parent = titleBar

	local title = Instance.new("TextLabel")
	title.Name = "ScriptTitle"
	title.Parent = titleBar
	title.BackgroundTransparency = 1
	title.Position = UDim2.new(0, 15, 0, 0)
	title.Size = UDim2.new(1, -30, 1, 0)
	title.Font = Enum.Font.GothamBlack
	title.Text = name
	title.TextColor3 = Colors.Text
	title.TextSize = 18
	title.TextXAlignment = Enum.TextXAlignment.Left
	local gdl = Instance.new("UIGradient"); gdl.Color = ColorSequence.new{
		ColorSequenceKeypoint.new(0, Color3.fromRGB(52,152,219)),
		ColorSequenceKeypoint.new(0.5, Color3.fromRGB(41,128,185)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(31,97,141))
	}; gdl.Parent = title
	spawn(function()
		while gui.Parent do
			Tween(gdl, 7, "Linear", "In", {Rotation = 360}); wait(7); gdl.Rotation = 0
		end
	end)

	local searchBar = Instance.new("Frame")
	searchBar.Name = "SearchBar"
	searchBar.Parent = main
	searchBar.BackgroundColor3 = Colors.Secondary
	searchBar.BackgroundTransparency = Colors.Transparent
	searchBar.Position = UDim2.new(0, 15, 0, 55)
	searchBar.Size = UDim2.new(1, -30, 0, 35)
	local searchBarC = Instance.new("UICorner"); searchBarC.CornerRadius = UDim.new(0, 6); searchBarC.Parent = searchBar
	CreateGlassEffect(searchBar)
	local searchIco = Instance.new("ImageLabel"); searchIco.Parent = searchBar; searchIco.BackgroundTransparency = 1
	searchIco.Position = UDim2.new(0, 10, 0.5, -10); searchIco.Size = UDim2.new(0, 20, 0, 20)
	searchIco.Image = "rbxassetid://3926305904"; searchIco.ImageRectOffset = Vector2.new(964, 324); searchIco.ImageRectSize = Vector2.new(36, 36); searchIco.ImageColor3 = Colors.Placeholder
	local searchBox = Instance.new("TextBox"); searchBox.Parent = searchBar; searchBox.BackgroundTransparency = 1
	searchBox.Position = UDim2.new(0, 40, 0, 0); searchBox.Size = UDim2.new(1, -50, 1, 0); searchBox.Font = Enum.Font.Gotham
	searchBox.PlaceholderText = "搜索标签页或功能..."; searchBox.Text = ""; searchBox.TextColor3 = Colors.Text; searchBox.PlaceholderColor3 = Colors.Placeholder; searchBox.TextSize = 14; searchBox.ClearTextOnFocus = false

	local content = Instance.new("Frame"); content.Name = "Content"; content.Parent = main; content.BackgroundTransparency = 1
	content.Position = UDim2.new(0, 0, 0, 100); content.Size = UDim2.new(1, 0, 1, -100)
	local side = Instance.new("Frame"); side.Name = "SideBar"; side.Parent = content; side.BackgroundColor3 = Colors.Secondary; side.BackgroundTransparency = Colors.Transparent; side.Size = UDim2.new(0, 140, 1, 0)
	local sideC = Instance.new("UICorner"); sideC.CornerRadius = UDim.new(0, 8); sideC.Parent = side; CreateGlassEffect(side)
	local tabBtns = Instance.new("ScrollingFrame"); tabBtns.Name = "TabBts"; tabBtns.Parent = side; tabBtns.Active = true; tabBtns.BackgroundTransparency = 1; tabBtns.BorderSizePixel = 0
	tabBtns.Position = UDim2.new(0, 5, 0, 5); tabBtns.Size = UDim2.new(1, -10, 1, -10); tabBtns.CanvasSize = UDim2.new(0, 0, 0, 0); tabBtns.ScrollBarThickness = 2; tabBtns.ScrollBarImageColor3 = Colors.Secondary
	local tabBtnsL = Instance.new("UIListLayout"); tabBtnsL.Parent = tabBtns; tabBtnsL.SortOrder = Enum.SortOrder.LayoutOrder; tabBtnsL.Padding = UDim.new(0, 8)
	tabBtnsL:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() tabBtns.CanvasSize = UDim2.new(0, 0, 0, tabBtnsL.AbsoluteContentSize.Y + 10) end)
	local tabMain = Instance.new("Frame"); tabMain.Name = "TabMain"; tabMain.Parent = content; tabMain.BackgroundTransparency = 1; tabMain.Position = UDim2.new(0, 145, 0, 0); tabMain.Size = UDim2.new(1, -145, 1, 0)

	local openBtn = Instance.new("ImageButton"); openBtn.Name = "Open"; openBtn.Parent = gui; openBtn.BackgroundColor3 = Colors.Primary; openBtn.BackgroundTransparency = Colors.Transparent
	openBtn.Position = UDim2.new(0.01, 0, 0.3, 0); openBtn.Size = UDim2.new(0, 35, 0, 35); openBtn.Image = "rbxassetid://3926305904"; openBtn.ImageRectOffset = Vector2.new(764, 324); openBtn.ImageRectSize = Vector2.new(36, 36)
	openBtn.ImageColor3 = Colors.Text; openBtn.Active = true; openBtn.Draggable = true; openBtn.ZIndex = 100
	local openBtnC = Instance.new("UICorner"); openBtnC.CornerRadius = UDim.new(0, 8); openBtnC.Parent = openBtn; CreateGlassEffect(openBtn)
	local openBtnS = Instance.new("UIStroke"); openBtnS.Color = Colors.Secondary; openBtnS.Thickness = 1; openBtnS.Transparency = 0.5; openBtnS.Parent = openBtn
	openBtn.MouseButton1Click:Connect(function()
		main.Visible = not main.Visible
		if main.Visible then Tween(main, 0.2, "Sine", "Out", {Size = UDim2.new(0, 650, 0, 400)}) end
	end)
	services.UserInputService.InputEnded:Connect(function(i) if i.KeyCode == Enum.KeyCode.LeftControl then main.Visible = not main.Visible end end)

	drag(main, titleBar)

	local allTabs, tabInfos, switching = {}, {}, false
	local function switchTab(new)
		if switching then return end
		local old = library.currentTab
		if old == nil then
			new.frame.Visible = true; library.currentTab = new
			Tween(new.button, 0.15, "Sine", "Out", {BackgroundTransparency = 0})
			Tween(new.button.TabText, 0.15, "Sine", "Out", {TextTransparency = 0})
			return
		end
		if old.button == new.button then return end
		switching = true; library.currentTab = new
		Tween(old.button, 0.15, "Sine", "Out", {BackgroundTransparency = 0.3})
		Tween(new.button, 0.15, "Sine", "Out", {BackgroundTransparency = 0})
		Tween(old.button.TabText, 0.15, "Sine", "Out", {TextTransparency = 0.3})
		Tween(new.button.TabText, 0.15, "Sine", "Out", {TextTransparency = 0})
		old.frame.Visible = false; new.frame.Visible = true
		task.wait(0.15); switching = false
	end

	searchBox:GetPropertyChangedSignal("Text"):Connect(function()
		local txt = searchBox.Text:lower()
		for _, ti in ipairs(allTabs) do
			local vis = txt == ""
			if not vis then
				vis = ti.name:lower():find(txt, 1, true) ~= nil
				if not vis then
					for _, c in ipairs(ti.searchableComponents or {}) do
						if c:lower():find(txt, 1, true) then vis = true; break end
					end
				end
			end
			ti.button.Visible = vis
		end
	end)

	local win = {}
	function win.Tab(win, name, icon)
		local btnFr = Instance.new("Frame"); btnFr.Name = "TabButton"; btnFr.Parent = tabBtns; btnFr.BackgroundColor3 = Colors.Secondary; btnFr.BackgroundTransparency = 0.3; btnFr.Size = UDim2.new(1, 0, 0, 40)
		local btnFrC = Instance.new("UICorner"); btnFrC.CornerRadius = UDim.new(0, 6); btnFrC.Parent = btnFr; CreateGlassEffect(btnFr)
		local ico = Instance.new("ImageLabel"); ico.Parent = btnFr; ico.BackgroundTransparency = 1; ico.Position = UDim2.new(0, 10, 0.5, -12); ico.Size = UDim2.new(0, 24, 0, 24); ico.Image = ("rbxassetid://%s"):format(icon or 4370341699); ico.ImageColor3 = Colors.Text
		local txt = Instance.new("TextLabel"); txt.Name = "TabText"; txt.Parent = btnFr; txt.BackgroundTransparency = 1; txt.Position = UDim2.new(0, 45, 0, 0); txt.Size = UDim2.new(1, -50, 1, 0); txt.Font = Enum.Font.GothamSemibold; txt.Text = name; txt.TextColor3 = Colors.Text; txt.TextSize = 14; txt.TextXAlignment = Enum.TextXAlignment.Left
		local btn = Instance.new("TextButton"); btn.Name = "TabBtn"; btn.Parent = btnFr; btn.BackgroundTransparency = 1; btn.Size = UDim2.new(1, 0, 1, 0); btn.Text = ""
		local fr = Instance.new("ScrollingFrame"); fr.Name = "Tab"; fr.Parent = tabMain; fr.BackgroundTransparency = 1; fr.Size = UDim2.new(1, 0, 1, 0); fr.CanvasSize = UDim2.new(0, 0, 0, 0); fr.ScrollBarThickness = 2; fr.Visible = false
		local frL = Instance.new("UIListLayout"); frL.Name = "TabL"; frL.Parent = fr; frL.SortOrder = Enum.SortOrder.LayoutOrder; frL.Padding = UDim.new(0, 8)
		local ti = {name = name, button = btnFr, frame = fr, searchableComponents = {}}
		table.insert(allTabs, ti)
		btn.MouseButton1Click:Connect(function() Ripple(btnFr); switchTab({button = btnFr, frame = fr}) end)
		if library.currentTab == nil then switchTab({button = btnFr, frame = fr}) end
		frL:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() fr.CanvasSize = UDim2.new(0, 0, 0, frL.AbsoluteContentSize.Y + 16) end)

		local tab = {}; tab._info = ti
		function tab.section(tab, secName, openDef)
			local sec = Instance.new("Frame"); sec.Name = "Section"; sec.Parent = fr; sec.BackgroundColor3 = Colors.Secondary; sec.BackgroundTransparency = Colors.Transparent; sec.BorderSizePixel = 0; sec.ClipsDescendants = true; sec.Size = UDim2.new(0.975, 0, 0, 42)
			local secC = Instance.new("UICorner"); secC.CornerRadius = UDim.new(0, 8); secC.Parent = sec; CreateGlassEffect(sec)
			local secS = Instance.new("UIStroke"); secS.Color = Colors.Primary; secS.Thickness = 1; secS.Transparency = 0.5; secS.Parent = sec
			local secTxt = Instance.new("TextLabel"); secTxt.Name = "SectionText"; secTxt.Parent = sec; secTxt.BackgroundTransparency = 1; secTxt.Position = UDim2.new(0, 40, 0, 0); secTxt.Size = UDim2.new(1, -45, 0, 42); secTxt.Font = Enum.Font.GothamBold; secTxt.Text = secName; secTxt.TextColor3 = Colors.Text; secTxt.TextSize = 16; secTxt.TextXAlignment = Enum.TextXAlignment.Left
			local secOpen = Instance.new("ImageLabel"); secOpen.Name = "SectionOpen"; secOpen.Parent = secTxt; secOpen.BackgroundTransparency = 1; secOpen.BorderSizePixel = 0; secOpen.Position = UDim2.new(0, -30, 0, 8); secOpen.Size = UDim2.new(0, 26, 0, 26); secOpen.Image = "http://www.roblox.com/asset/?id=6031302934"; secOpen.ImageColor3 = Colors.Text
			local secOpened = Instance.new("ImageLabel"); secOpened.Name = "SectionOpened"; secOpened.Parent = secOpen; secOpened.BackgroundTransparency = 1; secOpened.BorderSizePixel = 0; secOpened.Size = UDim2.new(0, 26, 0, 26); secOpened.Image = "http://www.roblox.com/asset/?id=6031302932"; secOpened.ImageTransparency = 1; secOpened.ImageColor3 = Colors.Text
			local secTog = Instance.new("ImageButton"); secTog.Name = "SectionToggle"; secTog.Parent = secOpen; secTog.BackgroundTransparency = 1; secTog.BorderSizePixel = 0; secTog.Size = UDim2.new(0, 26, 0, 26)
			local objs = Instance.new("Frame"); objs.Name = "Objs"; objs.Parent = sec; objs.BackgroundTransparency = 1; objs.BorderSizePixel = 0; objs.Position = UDim2.new(0, 6, 0, 42); objs.Size = UDim2.new(1, -12, 0, 0)
			local objsL = Instance.new("UIListLayout"); objsL.Name = "ObjsL"; objsL.Parent = objs; objsL.SortOrder = Enum.SortOrder.LayoutOrder; objsL.Padding = UDim.new(0, 8)
			local open = openDef ~= false
			if openDef ~= false then
				sec.Size = UDim2.new(0.975, 0, 0, open and 42 + objsL.AbsoluteContentSize.Y + 10 or 42)
				secOpened.ImageTransparency = open and 0 or 1; secOpen.ImageTransparency = open and 1 or 0
			end
			secTog.MouseButton1Click:Connect(function()
				open = not open; sec.Size = UDim2.new(0.975, 0, 0, open and 42 + objsL.AbsoluteContentSize.Y + 10 or 42)
				secOpened.ImageTransparency = open and 0 or 1; secOpen.ImageTransparency = open and 1 or 0
				Tween(sec, 0.2, "Sine", "Out", {BackgroundTransparency = open and 0.25 or 0})
			end)
			objsL:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() if not open then return end; sec.Size = UDim2.new(0.975, 0, 0, 42 + objsL.AbsoluteContentSize.Y + 10) end)

			local section = {}
			function section.Button(_, txt, cb)
				cb = cb or function() end; table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "BtnModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.Size = UDim2.new(1, 0, 0, 40)
				local b = Instance.new("TextButton"); b.Name = "Btn"; b.Parent = m; b.BackgroundColor3 = Colors.Secondary; b.BackgroundTransparency = 0.3; b.Size = UDim2.new(1, 0, 1, 0); b.AutoButtonColor = false; b.Font = Enum.Font.GothamSemibold; b.Text = "   " .. txt; b.TextColor3 = Colors.Text; b.TextSize = 15; b.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(b); local bc = Instance.new("UICorner"); bc.CornerRadius = UDim.new(0, 6); bc.Parent = b
				b.MouseButton1Click:Connect(function() Ripple(b); cb() end)
			end
			function section:Label(txt)
				table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "LabelModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.Size = UDim2.new(1, 0, 0, 30)
				local l = Instance.new("TextLabel"); l.Parent = m; l.BackgroundColor3 = Colors.Secondary; l.BackgroundTransparency = 0.3; l.Size = UDim2.new(1, 0, 1, 0); l.Font = Enum.Font.GothamSemibold; l.Text = txt; l.TextColor3 = Colors.Text; l.TextSize = 14; l.TextWrapped = true
				CreateGlassEffect(l); local lc = Instance.new("UICorner"); lc.CornerRadius = UDim.new(0, 6); lc.Parent = l; return l
			end
			function section.Toggle(_, txt, flag, def, cb)
				cb = cb or function() end; def = def or false; assert(txt and flag, "Toggle needs text and flag"); library.flags[flag] = def; table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "ToggleModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.Size = UDim2.new(1, 0, 0, 40)
				local b = Instance.new("TextButton"); b.Name = "ToggleBtn"; b.Parent = m; b.BackgroundColor3 = Colors.Secondary; b.BackgroundTransparency = 0.3; b.Size = UDim2.new(1, 0, 1, 0); b.AutoButtonColor = false; b.Font = Enum.Font.GothamSemibold; b.Text = "   " .. txt; b.TextColor3 = Colors.Text; b.TextSize = 15; b.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(b); local bc = Instance.new("UICorner"); bc.CornerRadius = UDim.new(0, 6); bc.Parent = b

				local togg = Instance.new("ImageButton"); togg.Name = "ToggleDisable"; togg.Parent = b; togg.BackgroundTransparency = 1; togg.Position = UDim2.new(1, -45, 0.5, -11); togg.Size = UDim2.new(0, 36, 0, 22); togg.AutoButtonColor = false
				local bs = Instance.new("TextLabel"); bs.Parent = togg; bs.BackgroundTransparency = 1; bs.Size = UDim2.new(1, 0, 1, 0); bs.Font = Enum.Font.GothamBold; bs.Text = "BS"; bs.TextSize = 14; bs.TextWrapped = true
				bs.TextColor3 = def and Colors.Accent or Color3.fromRGB(255, 255, 255)

				local funcs = {
					SetState = function(_, state)
						if state == nil then state = not library.flags[flag] end
						if library.flags[flag] == state then return end
						Tween(bs, 0.15, "Sine", "Out", {TextColor3 = state and Colors.Accent or Color3.fromRGB(255, 255, 255)})
						library.flags[flag] = state; cb(state)
					end,
					Module = m
				}
				if def then funcs:SetState(true) end
				togg.MouseButton1Click:Connect(function() funcs:SetState() end)
				return funcs
			end
			function section.Keybind(_, txt, defKey, cb)
				cb = cb or function() end; assert(txt and defKey, "Keybind needs text and default"); local banned = {Return = true, Space = true, Tab = true, Backquote = true, CapsLock = true, Escape = true, Unknown = true}
				local short = {RightControl = "Right Ctrl", LeftControl = "Left Ctrl", LeftShift = "Left Shift", RightShift = "Right Shift", Semicolon = ";", Quote = '"', LeftBracket = "[", RightBracket = "]", Equals = "=", Minus = "-", RightAlt = "Right Alt", LeftAlt = "Left Alt"}
				local key = typeof(defKey) == "string" and Enum.KeyCode[defKey] or defKey; local disp = (key and (short[key.Name] or key.Name) or "None"); table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "KeybindModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.Size = UDim2.new(1, 0, 0, 40)
				local b = Instance.new("TextButton"); b.Name = "KeybindBtn"; b.Parent = m; b.BackgroundColor3 = Colors.Secondary; b.BackgroundTransparency = 0.3; b.Size = UDim2.new(1, 0, 1, 0); b.AutoButtonColor = false; b.Font = Enum.Font.GothamSemibold; b.Text = "   " .. txt; b.TextColor3 = Colors.Text; b.TextSize = 15; b.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(b); local bc = Instance.new("UICorner"); bc.CornerRadius = UDim.new(0, 6); bc.Parent = b
				local val = Instance.new("TextButton"); val.Name = "KeybindValue"; val.Parent = b; val.BackgroundColor3 = Colors.Primary; val.BackgroundTransparency = 0.5; val.Position = UDim2.new(1, -60, 0.5, -14); val.Size = UDim2.new(0, 55, 0, 28); val.AutoButtonColor = false; val.Font = Enum.Font.GothamSemibold; val.Text = disp; val.TextColor3 = Colors.Text; val.TextSize = 14
				local vc = Instance.new("UICorner"); vc.CornerRadius = UDim.new(0, 6); vc.Parent = val
				services.UserInputService.InputBegan:Connect(function(io, g) if g then return end; if io.UserInputType == Enum.UserInputType.Keyboard and io.KeyCode == key then cb(key.Name) end end)
				val.MouseButton1Click:Connect(function()
					val.Text = "..."; local io = services.UserInputService.InputEnded:Wait(); local n = tostring(io.KeyCode.Name)
					if io.UserInputType ~= Enum.UserInputType.Keyboard or banned[n] then val.Text = disp; return end
					key = Enum.KeyCode[n]; disp = short[n] or n; val.Text = disp
				end)
				val:GetPropertyChangedSignal("TextBounds"):Connect(function() val.Size = UDim2.new(0, val.TextBounds.X + 30, 0, 28) end); val.Size = UDim2.new(0, val.TextBounds.X + 30, 0, 28)
			end
			function section.Textbox(_, txt, flag, def, cb)
				cb = cb or function() end; assert(txt and flag and def, "Textbox needs text, flag and default"); library.flags[flag] = def; table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "TextboxModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.Size = UDim2.new(1, 0, 0, 40)
				local back = Instance.new("TextButton"); back.Name = "TextboxBack"; back.Parent = m; back.BackgroundColor3 = Colors.Secondary; back.BackgroundTransparency = 0.3; back.Size = UDim2.new(1, 0, 1, 0); back.AutoButtonColor = false; back.Font = Enum.Font.GothamSemibold; back.Text = "   " .. txt; back.TextColor3 = Colors.Text; back.TextSize = 15; back.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(back); local bc = Instance.new("UICorner"); bc.CornerRadius = UDim.new(0, 6); bc.Parent = back
				local boxBg = Instance.new("TextButton"); boxBg.Name = "BoxBG"; boxBg.Parent = back; boxBg.BackgroundColor3 = Colors.Primary; boxBg.BackgroundTransparency = 0.5; boxBg.Position = UDim2.new(1, -100, 0.5, -14); boxBg.Size = UDim2.new(0, 90, 0, 28); boxBg.AutoButtonColor = false; boxBg.Text = ""
				local boxBgC = Instance.new("UICorner"); boxBgC.CornerRadius = UDim.new(0, 6); boxBgC.Parent = boxBg
				local box = Instance.new("TextBox"); box.Parent = boxBg; box.BackgroundTransparency = 1; box.Size = UDim2.new(1, 0, 1, 0); box.Font = Enum.Font.Gotham; box.Text = def; box.TextColor3 = Colors.Text; box.PlaceholderColor3 = Colors.Placeholder; box.TextSize = 14; box.ClearTextOnFocus = false
				box.FocusLost:Connect(function()
					if box.Text == "" then box.Text = def end; library.flags[flag] = box.Text; cb(box.Text)
				end)
				box:GetPropertyChangedSignal("TextBounds"):Connect(function() boxBg.Size = UDim2.new(0, box.TextBounds.X + 40, 0, 28) end); boxBg.Size = UDim2.new(0, box.TextBounds.X + 40, 0, 28)
			end
			function section.Slider(_, txt, flag, def, min, max, precise, cb)
				cb = cb or function() end; min = min or 1; max = max or 10; def = def or min; precise = precise or false; library.flags[flag] = def; assert(txt and flag and def, "Slider needs text, flag and default"); table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "SliderModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.ClipsDescendants = true; m.Size = UDim2.new(1, 0, 0, 40)
				local back = Instance.new("TextButton"); back.Name = "SliderBack"; back.Parent = m; back.BackgroundColor3 = Colors.Secondary; back.BackgroundTransparency = 0.3; back.Size = UDim2.new(1, 0, 1, 0); back.AutoButtonColor = false; back.Font = Enum.Font.GothamSemibold; back.Text = "   " .. txt; back.TextColor3 = Colors.Text; back.TextSize = 15; back.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(back); local bc = Instance.new("UICorner"); bc.CornerRadius = UDim.new(0, 6); bc.Parent = back
				local bar = Instance.new("Frame"); bar.Name = "SliderBar"; bar.Parent = back; bar.AnchorPoint = Vector2.new(0, 0.5); bar.BackgroundColor3 = Colors.Primary; bar.BackgroundTransparency = 0.5; bar.BorderSizePixel = 0; bar.Position = UDim2.new(0.5, -60, 0.5, 0); bar.Size = UDim2.new(0, 120, 0, 6)
				local barC = Instance.new("UICorner"); barC.CornerRadius = UDim.new(0, 3); barC.Parent = bar
				local part = Instance.new("Frame"); part.Name = "SliderPart"; part.Parent = bar; part.BackgroundColor3 = Colors.Accent; part.Size = UDim2.new((def - min) / (max - min), 0, 1, 0)
				local partC = Instance.new("UICorner"); partC.CornerRadius = UDim.new(0, 3); partC.Parent = part
				local valBg = Instance.new("TextButton"); valBg.Name = "SliderValBG"; valBg.Parent = back; valBg.BackgroundColor3 = Colors.Primary; valBg.BackgroundTransparency = 0.5; valBg.Position = UDim2.new(1, -45, 0.5, -14); valBg.Size = UDim2.new(0, 40, 0, 28); valBg.AutoButtonColor = false; valBg.Font = Enum.Font.Gotham; valBg.Text = ""
				local valBgC = Instance.new("UICorner"); valBgC.CornerRadius = UDim.new(0, 6); valBgC.Parent = valBg
				local val = Instance.new("TextBox"); val.Parent = valBg; val.BackgroundTransparency = 1; val.Size = UDim2.new(1, 0, 1, 0); val.Font = Enum.Font.GothamSemibold; val.Text = tostring(def); val.TextColor3 = Colors.Text; val.TextSize = 14
				local sub = Instance.new("TextButton"); sub.Name = "MinSlider"; sub.Parent = back; sub.BackgroundTransparency = 1; sub.Position = UDim2.new(0.5, -85, 0.5, -10); sub.Size = UDim2.new(0, 20, 0, 20); sub.Font = Enum.Font.GothamBold; sub.Text = "-"; sub.TextColor3 = Colors.Text; sub.TextSize = 20
				local add = Instance.new("TextButton"); add.Name = "AddSlider"; add.Parent = back; add.AnchorPoint = Vector2.new(0, 0.5); add.BackgroundTransparency = 1; add.Position = UDim2.new(0.5, 70, 0.5, -10); add.Size = UDim2.new(0, 20, 0, 20); add.Font = Enum.Font.GothamBold; add.Text = "+"; add.TextColor3 = Colors.Text; add.TextSize = 20
				local funcs = {
					SetValue = function(_, v)
						local pct = (mouse.X - bar.AbsolutePosition.X) / bar.AbsoluteSize.X
						if v then pct = (v - min) / (max - min) end
						pct = math.clamp(pct, 0, 1)
						v = precise and tonumber(string.format("%.1f", min + (max - min) * pct)) or math.floor(min + (max - min) * pct)
						library.flags[flag] = v; val.Text = tostring(v); Tween(part, 0.1, "Linear", "Out", {Size = UDim2.new(pct, 0, 1, 0)}); cb(v)
					end
				}
				sub.MouseButton1Click:Connect(function() funcs:SetValue(math.clamp(library.flags[flag] - 1, min, max)) end)
				add.MouseButton1Click:Connect(function() funcs:SetValue(math.clamp(library.flags[flag] + 1, min, max)) end)
				funcs:SetValue(def)
				local dragging = false
				bar.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then dragging = true; funcs:SetValue() end end)
				services.UserInputService.InputEnded:Connect(function(i) if (i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch) and dragging then dragging = false end end)
				services.UserInputService.InputChanged:Connect(function(i) if dragging and (i.UserInputType == Enum.UserInputType.MouseMovement or i.UserInputType == Enum.UserInputType.Touch) then funcs:SetValue() end end)
				local focused = false; val.Focused:Connect(function() focused = true end); val.FocusLost:Connect(function() focused = false; if val.Text == "" then funcs:SetValue(def) end end)
				val:GetPropertyChangedSignal("Text"):Connect(function()
					if not focused then return end; val.Text = val.Text:gsub("%D+", ""); local n = tonumber(val.Text); if not n then return end; if n > max then val.Text = tostring(max) end; funcs:SetValue(tonumber(val.Text))
				end)
				return funcs
			end
			function section.Dropdown(_, txt, flag, opts, cb)
				cb = cb or function() end; opts = opts or {}; assert(txt and flag, "Dropdown needs text and flag"); library.flags[flag] = nil; table.insert(ti.searchableComponents, txt)
				local m = Instance.new("Frame"); m.Name = "DropdownModule"; m.Parent = objs; m.BackgroundTransparency = 1; m.ClipsDescendants = true; m.Size = UDim2.new(1, 0, 0, 40)
				local top = Instance.new("TextButton"); top.Name = "DropdownTop"; top.Parent = m; top.BackgroundColor3 = Colors.Secondary; top.BackgroundTransparency = 0.3; top.Size = UDim2.new(1, 0, 0, 40); top.AutoButtonColor = false; top.Font = Enum.Font.GothamSemibold; top.Text = ""; top.TextXAlignment = Enum.TextXAlignment.Left
				CreateGlassEffect(top); local tc = Instance.new("UICorner"); tc.CornerRadius = UDim.new(0, 6); tc.Parent = top
				local tbox = Instance.new("TextBox"); tbox.Name = "DropdownText"; tbox.Parent = top; tbox.BackgroundTransparency = 1; tbox.Position = UDim2.new(0, 40, 0, 0); tbox.Size = UDim2.new(1, -70, 1, 0); tbox.Font = Enum.Font.GothamSemibold; tbox.PlaceholderText = txt; tbox.Text = ""; tbox.TextColor3 = Colors.Text; tbox.TextSize = 15; tbox.TextXAlignment = Enum.TextXAlignment.Left; tbox.ClearTextOnFocus = false
				local opn = Instance.new("TextButton"); opn.Name = "DropdownOpen"; opn.Parent = top; opn.AnchorPoint = Vector2.new(0, 0.5); opn.BackgroundTransparency = 1; opn.Position = UDim2.new(1, -30, 0.5, 0); opn.Size = UDim2.new(0, 20, 0, 20); opn.Font = Enum.Font.GothamBold; opn.Text = "+"; opn.TextColor3 = Colors.Text; opn.TextSize = 20
				local ml = Instance.new("UIListLayout"); ml.Name = "DropdownModuleL"; ml.Parent = m; ml.SortOrder = Enum.SortOrder.LayoutOrder; ml.Padding = UDim.new(0, 4)
				local open = false; local funcs = {
					AddOption = function(_, opt)
						local o = Instance.new("TextButton"); o.Name = "Option_" .. opt; o.Parent = m; o.BackgroundColor3 = Colors.Secondary; o.BackgroundTransparency = 0.3; o.Size = UDim2.new(1, 0, 0, 32); o.AutoButtonColor = false; o.Font = Enum.Font.Gotham; o.Text = opt; o.TextColor3 = Colors.Text; o.TextSize = 14
						CreateGlassEffect(o); local oc = Instance.new("UICorner"); oc.CornerRadius = UDim.new(0, 6); oc.Parent = o
						o.MouseButton1Click:Connect(function()
							open = false; opn.Text = "+"; Tween(m, 0.2, "Sine", "Out", {Size = UDim2.new(1, 0, 0, 40)}); cb(o.Text); tbox.Text = o.Text; library.flags[flag] = o.Text
						end)
					end,
					SetOptions = function(_, list)
						if not list or typeof(list) ~= "table" then return end
						for _, v in next, m:GetChildren() do if v.Name:match("Option_") then v:Destroy() end end
						for _, v in next, list do funcs:AddOption(v) end
					end,
					ToggleDropVis = function()
						open = not open; opn.Text = open and "-" or "+"; Tween(m, 0.2, "Sine", "Out", {Size = UDim2.new(1, 0, 0, open and ml.AbsoluteContentSize.Y + 4 or 40)})
					end
				}
				opn.MouseButton1Click:Connect(function() funcs:ToggleDropVis() end)
				ml:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() if open then Tween(m, 0.2, "Sine", "Out", {Size = UDim2.new(1, 0, 0, ml.AbsoluteContentSize.Y + 4}) end end)
				funcs:SetOptions(opts); return funcs
			end
			section.TextBox = section.Textbox; section.textbox = section.Textbox; section.KeyBind = section.Keybind; section.keybind = section.Keybind
			return section
		end
		return tab
	end
	return win
end

return library